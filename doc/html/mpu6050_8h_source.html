<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gyro and Peripheral NRF52-DK Demo: src/mpu6050.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gyro and Peripheral NRF52-DK Demo
   &#160;<span id="projectnumber">1.0.3</span>
   </div>
   <div id="projectbrief">The device will start and make advertising every 5 seconds and user could find the device by NRF connect. As user connect he/she should see a custom service with a few characteristics: gyro AX, AY, AZ and peripheral control. Select the peripheral control and send the command (0x01, 0x02, 0x03) to turn led on. After this, user could read the last gyro values (just update these values, when we have moves - interrupts from the sensor) from the gyro characteristick.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mpu6050.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mpu6050_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifndef __MPU6050_H__</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#define __MPU6050_H__</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;mbed.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define XGOFFS_TC 0x00</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#define YGOFFS_TC 0x01</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define ZGOFFS_TC 0x02</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define X_FINE_GAIN 0x03</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define Y_FINE_GAIN 0x04</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#define Z_FINE_GAIN 0x05</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#define XA_OFFSET_H 0x06</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#define XA_OFFSET_L_TC 0x07</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#define YA_OFFSET_H 0x08</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#define YA_OFFSET_L_TC 0x09</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#define ZA_OFFSET_H 0x0A</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define ZA_OFFSET_L_TC 0x0B</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#define SELF_TEST_X 0x0D</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#define SELF_TEST_Y 0x0E</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#define SELF_TEST_Z 0x0F</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#define SELF_TEST_A 0x10</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#define XG_OFFS_USRH 0x13</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#define XG_OFFS_USRL 0x14</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#define YG_OFFS_USRH 0x15</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define YG_OFFS_USRL 0x16</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#define ZG_OFFS_USRH 0x17</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#define ZG_OFFS_USRL 0x18</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#define SMPLRT_DIV 0x19</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#define CONFIG 0x1A</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#define GYRO_CONFIG 0x1B</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#define ACCEL_CONFIG 0x1C</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#define FF_THR 0x1D</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#define FF_DUR 0x1E</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define MOT_THR 0x1F</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#define MOT_DUR 0x20</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#define ZMOT_THR 0x21</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#define ZRMOT_DUR 0x22</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#define FIFO_EN 0x23</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#define I2C_MST_CTRL 0x24</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#define I2C_SLV0_ADDR 0x25</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#define I2C_SLV0_REG 0x26</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#define I2C_SLV0_CTRL 0x27</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#define I2C_SLV1_ADDR 0x28</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#define I2C_SLV1_REG 0x29</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#define I2C_SLV1_CTRL 0x2A</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#define I2C_SLV2_ADDR 0x2B</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define I2C_SLV2_REG 0x2C</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define I2C_SLV2_CTRL 0x2D</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define I2C_SLV3_ADDR 0x2E</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#define I2C_SLV3_REG 0x2F</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#define I2C_SLV3_CTRL 0x30</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#define I2C_SLV4_ADDR 0x31</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define I2C_SLV4_REG 0x32</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#define I2C_SLV4_DO 0x33</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define I2C_SLV4_CTRL 0x34</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#define I2C_SLV4_DI 0x35</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#define I2C_MST_STATUS 0x36</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#define INT_PIN_CFG 0x37 </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#define INT_ENABLE 0x38</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#define DMP_INT_STATUS 0x39 </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#define INT_STATUS 0x3A</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#define ACCEL_XOUT_H 0x3B</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#define ACCEL_XOUT_L 0x3C</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#define ACCEL_YOUT_H 0x3D</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#define ACCEL_YOUT_L 0x3E</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#define ACCEL_ZOUT_H 0x3F</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#define ACCEL_ZOUT_L 0x40</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#define TEMP_OUT_H 0x41</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#define TEMP_OUT_L 0x42</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#define GYRO_XOUT_H 0x43</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#define GYRO_XOUT_L 0x44</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#define GYRO_YOUT_H 0x45</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#define GYRO_YOUT_L 0x46</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#define GYRO_ZOUT_H 0x47</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#define GYRO_ZOUT_L 0x48</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_00 0x49</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_01 0x4A</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_02 0x4B</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_03 0x4C</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_04 0x4D</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_05 0x4E</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_06 0x4F</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_07 0x50</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_08 0x51</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_09 0x52</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_10 0x53</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_11 0x54</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_12 0x55</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_13 0x56</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_14 0x57</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_15 0x58</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_16 0x59</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_17 0x5A</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_18 0x5B</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_19 0x5C</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_20 0x5D</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_21 0x5E</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_22 0x5F</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#define EXT_SENS_DATA_23 0x60</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#define MOT_DETECT_STATUS 0x61</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#define I2C_SLV0_DO 0x63</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#define I2C_SLV1_DO 0x64</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#define I2C_SLV2_DO 0x65</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#define I2C_SLV3_DO 0x66</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#define I2C_MST_DELAY_CTRL 0x67</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#define SIGNAL_PATH_RESET 0x68</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#define MOT_DETECT_CTRL 0x69</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#define USER_CTRL 0x6A</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#define PWR_MGMT_1 0x6B</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#define PWR_MGMT_2 0x6C</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#define DMP_BANK 0x6D</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#define DMP_RW_PNT 0x6E</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#define DMP_REG 0x6F</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#define DMP_REG_1 0x70</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#define DMP_REG_2 0x71</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#define FIFO_COUNTH 0x72</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#define FIFO_COUNTL 0x73</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#define FIFO_R_W 0x74</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#define WHO_AM_I_MPU6050 0x75</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_INT_LEVEL_BIT 7</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_INT_OPEN_BIT 6</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_LATCH_INT_EN_BIT 5</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_INT_RD_CLEAR_BIT 4</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_FSYNC_INT_LEVEL_BIT 3</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_FSYNC_INT_EN_BIT 2</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_I2C_BYPASS_EN_BIT 1</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#define MPU6050_INTCFG_CLKOUT_EN_BIT 0</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#define ADO 0</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#if ADO</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#define MPU6050_ADDRESS 0x69 &lt;&lt; 1 </span><span class="comment">/* Device address when ADO = 1 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#define MPU6050_ADDRESS 0x68 &lt;&lt; 1 </span><span class="comment">/* Device address when ADO = 0 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#define MPU_I2C_SDA P0_26</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#define MPU_I2C_SCL P0_27</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;I2C i2c(MPU_I2C_SDA, MPU_I2C_SCL);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">enum</span> Ascale</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    AFS_2G = 0,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    AFS_4G,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    AFS_8G,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    AFS_16G</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;};</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">enum</span> Gscale</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    GFS_250DPS = 0,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    GFS_500DPS,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    GFS_1000DPS,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    GFS_2000DPS</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;};</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Gscale = GFS_250DPS; <span class="comment">/* Set gyro  scale */</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Ascale = AFS_2G;     <span class="comment">/* Set accel scale */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">static</span> <span class="keywordtype">float</span> aRes, gRes;                                        <span class="comment">/* Scale resolutions per LSB for the sensors           */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">static</span> <span class="keywordtype">float</span> ax, ay, az;                                        <span class="comment">/* Stores the real accel value in g&#39;s                  */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">static</span> int16_t gyroCount[3];                                    <span class="comment">/* Stores the 16-bit signed gyro sensor output         */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">static</span> <span class="keywordtype">float</span> gx, gy, gz;                                        <span class="comment">/* Stores the real gyro value in degrees per seconds   */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">static</span> <span class="keywordtype">float</span> gyroBias[3] = {0, 0, 0}, accelBias[3] = {0, 0, 0}; <span class="comment">/* Bias corrections for gyro and accelerometer         */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">  215</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">fromADCtoInt</a>(<span class="keywordtype">long</span> value, <span class="keywordtype">long</span> from_min, <span class="keywordtype">long</span> from_max, <span class="keywordtype">long</span> to_min, <span class="keywordtype">long</span> to_max)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> (value - from_min) * (to_max - to_min) / (from_max - from_min) + to_min;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classMPU6050.html">  220</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMPU6050.html">MPU6050</a></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">void</span> writeByte(uint8_t address, uint8_t subAddress, uint8_t data)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">char</span> data_write[2];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        data_write[0] = subAddress;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        data_write[1] = data;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        i2c.write(address, data_write, 2, 0);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">char</span> readByte(uint8_t address, uint8_t subAddress)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordtype">char</span> data[1]; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordtype">char</span> data_write[1];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        data_write[0] = subAddress;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        i2c.write(address, data_write, 1, 1);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        i2c.read(address, data, 1, 0);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">return</span> data[0];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">void</span> readBytes(uint8_t address, uint8_t subAddress, uint8_t count, uint8_t *dest)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordtype">char</span> data[14];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordtype">char</span> data_write[1];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        data_write[0] = subAddress;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        i2c.write(address, data_write, 1, 1); <span class="comment">// no stop</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        i2c.read(address, data, count, 0);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; count; ii++)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            dest[ii] = data[ii];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classMPU6050.html#a6c1feece6ebce637f1dfc62b4e51b505">  262</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#a6c1feece6ebce637f1dfc62b4e51b505">getGres</a>()</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">switch</span> (Gscale)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">case</span> GFS_250DPS:</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            gRes = 250.0 / 32768.0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">case</span> GFS_500DPS:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            gRes = 500.0 / 32768.0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">case</span> GFS_1000DPS:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            gRes = 1000.0 / 32768.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">case</span> GFS_2000DPS:</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            gRes = 2000.0 / 32768.0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classMPU6050.html#ad4c9e5da02513d6da3226e61717f45d8">  288</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#ad4c9e5da02513d6da3226e61717f45d8">getAres</a>()</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">switch</span> (Ascale)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">case</span> AFS_2G:</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            aRes = 2.0 / 32768.0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">case</span> AFS_4G:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            aRes = 4.0 / 32768.0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">case</span> AFS_8G:</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            aRes = 8.0 / 32768.0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">case</span> AFS_16G:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            aRes = 16.0 / 32768.0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classMPU6050.html#aeba6e510256e9ce45d60ad5f2e9730ea">  315</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#aeba6e510256e9ce45d60ad5f2e9730ea">readAccelData</a>(int16_t *destination)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        uint8_t rawData[6];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        readBytes(MPU6050_ADDRESS, ACCEL_XOUT_H, 6, &amp;rawData[0]);            </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        destination[0] = (int16_t)(((int16_t)rawData[0] &lt;&lt; 8) | rawData[1]); </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        destination[1] = (int16_t)(((int16_t)rawData[2] &lt;&lt; 8) | rawData[3]);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        destination[2] = (int16_t)(((int16_t)rawData[4] &lt;&lt; 8) | rawData[5]);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classMPU6050.html#a85697978821b9750a663ad0da2665149">  332</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#a85697978821b9750a663ad0da2665149">readGyroData</a>(int16_t *destination)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        uint8_t rawData[6];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        readBytes(MPU6050_ADDRESS, GYRO_XOUT_H, 6, &amp;rawData[0]);             </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        destination[0] = (int16_t)(((int16_t)rawData[0] &lt;&lt; 8) | rawData[1]); </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        destination[1] = (int16_t)(((int16_t)rawData[2] &lt;&lt; 8) | rawData[3]);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        destination[2] = (int16_t)(((int16_t)rawData[4] &lt;&lt; 8) | rawData[5]);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classMPU6050.html#a25e6783c8ced9bddbf7a76ad6c0d862b">  348</a></span>&#160;    uint8_t <a class="code" href="classMPU6050.html#a25e6783c8ced9bddbf7a76ad6c0d862b">getTinyGyroX</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">fromADCtoInt</a>(gyroCount[0], -32768, +32767, -250, +250);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classMPU6050.html#a0f2fa52481baa9149ae3de0f4f1ccd55">  360</a></span>&#160;    uint8_t <a class="code" href="classMPU6050.html#a0f2fa52481baa9149ae3de0f4f1ccd55">getTinyGyroY</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">fromADCtoInt</a>(gyroCount[1], -32768, +32767, -250, +250);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classMPU6050.html#af9abab30196b2e4aa39aaa19d361cef4">  372</a></span>&#160;    uint8_t <a class="code" href="classMPU6050.html#af9abab30196b2e4aa39aaa19d361cef4">getTinyGyroZ</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">fromADCtoInt</a>(gyroCount[2], -32768, +32767, -250, +250);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classMPU6050.html#a144c5eeb14c620d9df9bb601dabcdfe4">  388</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#a144c5eeb14c620d9df9bb601dabcdfe4">lowPowerAccelOnly</a>()</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        uint8_t c = readByte(MPU6050_ADDRESS, PWR_MGMT_1);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">/* Clear sleep and cycle bits [5:6] */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, c &amp; ~0x30);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">/* Set sleep and cycle bits [5:6] to zero to make sure accelerometer is running */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, c | 0x30);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        c = readByte(MPU6050_ADDRESS, PWR_MGMT_2);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">/* Clear standby XA, YA, and ZA bits [3:5] */</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_2, c &amp; ~0x38);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">/* Set XA, YA, and ZA bits [3:5] to zero to make sure accelerometer is running */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_2, c | 0x00);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        c = readByte(MPU6050_ADDRESS, ACCEL_CONFIG);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">/* Clear high-pass filter bits [2:0] */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c &amp; ~0x07);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">/* Set ACCEL_HPF to 0; reset mode disbaling high-pass filter */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c | 0x00);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        c = readByte(MPU6050_ADDRESS, CONFIG);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">/* Clear low-pass filter bits [2:0] */</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        writeByte(MPU6050_ADDRESS, CONFIG, c &amp; ~0x07);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">/* Set DLPD_CFG to 0; 260 Hz bandwidth, 1 kHz rate */</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        writeByte(MPU6050_ADDRESS, CONFIG, c | 0x00);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        c = readByte(MPU6050_ADDRESS, INT_ENABLE);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">/* Clear all interrupts */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        writeByte(MPU6050_ADDRESS, INT_ENABLE, c &amp; ~0xFF);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">/* Enable motion threshold (bits 5) interrupt only */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        writeByte(MPU6050_ADDRESS, INT_ENABLE, 0x40);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">/* Set motion detection to 0.256 g; LSB = 2 mg */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        writeByte(MPU6050_ADDRESS, MOT_THR, 0x80);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">/* Set motion detect duration to 1  ms; LSB is 1 ms @ 1 kHz rate */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        writeByte(MPU6050_ADDRESS, MOT_DUR, 0x01);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">/* Add delay for accumulation of samples */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        thread_sleep_for(100);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        c = readByte(MPU6050_ADDRESS, ACCEL_CONFIG);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">/* Clear high-pass filter bits [2:0] */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c &amp; ~0x07);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">/* Set ACCEL_HPF to 7; hold the initial accleration value as a referance */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c | 0x07);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        c = readByte(MPU6050_ADDRESS, PWR_MGMT_2);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">/* Clear standby XA, YA, and ZA bits [3:5] and LP_WAKE_CTRL bits [6:7] */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_2, c &amp; ~0xC7);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">/* Set wakeup frequency to 5 Hz, and disable XG, YG, and ZG gyros (bits [0:2]) */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_2, c | 0x47);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        c = readByte(MPU6050_ADDRESS, PWR_MGMT_1);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">/* Clear sleep and cycle bit 5 */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, c &amp; ~0x20);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">/* Set cycle bit 5 to begin low power accelerometer motion interrupts */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, c | 0x20);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classMPU6050.html#a7100b6d276c3c8664cf00d768b7b0dee">  454</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#a7100b6d276c3c8664cf00d768b7b0dee">reset</a>()</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x80); </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        thread_sleep_for(100);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classMPU6050.html#ac13cbf2fc086558a1aaab5ad0ac350e5">  469</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#ac13cbf2fc086558a1aaab5ad0ac350e5">init</a>()</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">/* Clear sleep mode bit (6), enable all sensors */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x00);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        thread_sleep_for(100);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">/* Set clock source to be PLL with x-axis gyroscope reference, bits 2:0 = 001 */</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x01);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        writeByte(MPU6050_ADDRESS, CONFIG, 0x03);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">/* Set sample rate = gyroscope output rate/(1 + SMPLRT_DIV) */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">/* Use a 200 Hz rate; the same rate set in CONFIG above */</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        writeByte(MPU6050_ADDRESS, SMPLRT_DIV, 0x04);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">/* Set gyroscope full scale range */</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">/* Range selects FS_SEL and AFS_SEL are 0 - 3, so 2-bit values are left-shifted into positions 4:3 */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        uint8_t c = readByte(MPU6050_ADDRESS, GYRO_CONFIG);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">/* Clear self-test bits [7:5] */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        writeByte(MPU6050_ADDRESS, GYRO_CONFIG, c &amp; ~0xE0);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">/* Clear AFS bits [4:3] */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        writeByte(MPU6050_ADDRESS, GYRO_CONFIG, c &amp; ~0x18);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">/* Set full scale range for the gyro */</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        writeByte(MPU6050_ADDRESS, GYRO_CONFIG, c | Gscale &lt;&lt; 3);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">/* Set accelerometer configuration */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        c = readByte(MPU6050_ADDRESS, ACCEL_CONFIG);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">/* Clear self-test bits [7:5] */</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c &amp; ~0xE0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">/* Clear AFS bits [4:3] */</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c &amp; ~0x18);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">/* Set full scale range for the accelerometer */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, c | Ascale &lt;&lt; 3);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">/* Set interrupt pin active high, push-pull, and clear on read of INT_STATUS, enable I2C_BYPASS_EN */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        writeByte(MPU6050_ADDRESS, INT_PIN_CFG, 0x22);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">/* 0x01 Enable data ready (bit 0) interrupt */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        writeByte(MPU6050_ADDRESS, INT_ENABLE, 0x01);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classMPU6050.html#a9e714480274e46034d7178f31401095e">  517</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMPU6050.html#a9e714480274e46034d7178f31401095e">calibrate</a>(<span class="keywordtype">float</span> *dest1, <span class="keywordtype">float</span> *dest2)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        uint8_t data[12];</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        uint16_t p, packet_count, fifo_count;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        int32_t gyro_bias[3] = {0, 0, 0}, accel_bias[3] = {0, 0, 0};</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">/* Write a one to bit 7 reset bit; toggle reset device */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x80);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        thread_sleep_for(100);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">/* Set clock source to be PLL with x-axis gyroscope reference, bits 2:0 = 001 */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x01);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_2, 0x00);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        thread_sleep_for(100);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        writeByte(MPU6050_ADDRESS, INT_ENABLE, 0x00);   <span class="comment">/* Disable all interrupts            */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        writeByte(MPU6050_ADDRESS, FIFO_EN, 0x00);      <span class="comment">/* Disable FIFO                      */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        writeByte(MPU6050_ADDRESS, PWR_MGMT_1, 0x00);   <span class="comment">/* Turn on internal clock source     */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        writeByte(MPU6050_ADDRESS, I2C_MST_CTRL, 0x00); <span class="comment">/* Disable I2C master                */</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        writeByte(MPU6050_ADDRESS, USER_CTRL, 0x00);    <span class="comment">/* Disable FIFO and I2C master modes */</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        writeByte(MPU6050_ADDRESS, USER_CTRL, 0x0C);    <span class="comment">/* Reset FIFO and DMP                */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        thread_sleep_for(150);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        writeByte(MPU6050_ADDRESS, CONFIG, 0x01);       <span class="comment">/* Set low-pass filter to 188 Hz                                      */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        writeByte(MPU6050_ADDRESS, SMPLRT_DIV, 0x00);   <span class="comment">/* Set sample rate to 1 kHz                                           */</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        writeByte(MPU6050_ADDRESS, GYRO_CONFIG, 0x00);  <span class="comment">/* Set gyro full-scale to 250 degrees per second, maximum sensitivity */</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        writeByte(MPU6050_ADDRESS, ACCEL_CONFIG, 0x00); <span class="comment">/* Set accelerometer full-scale to 2 g, maximum sensitivity           */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        uint16_t gyrosensitivity = 131;    <span class="comment">/* 131 LSB/degrees/sec */</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        uint16_t accelsensitivity = 16384; <span class="comment">/* 16384 LSB/g         */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">/* Configure FIFO to capture accelerometer and gyro data for bias calculation */</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        writeByte(MPU6050_ADDRESS, USER_CTRL, 0x40); <span class="comment">/* Enable FIFO                                    */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        writeByte(MPU6050_ADDRESS, FIFO_EN, 0x78);   <span class="comment">/* Enable gyro and accelerometer sensors for FIFO */</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        thread_sleep_for(80);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">/* Disable gyro and accelerometer sensors for FIFO */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        writeByte(MPU6050_ADDRESS, FIFO_EN, 0x00);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">/* Read FIFO sample count */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        readBytes(MPU6050_ADDRESS, FIFO_COUNTH, 2, &amp;data[0]);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        fifo_count = ((uint16_t)data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        packet_count = fifo_count / 12;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; packet_count; p++)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            int16_t accel_temp[3] = {0, 0, 0}, gyro_temp[3] = {0, 0, 0};</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="comment">/* Read data for averaging */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            readBytes(MPU6050_ADDRESS, FIFO_R_W, 12, &amp;data[0]);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment">/* Form signed 16-bit integer for each sample in FIFO */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            accel_temp[0] = (int16_t)(((int16_t)data[0] &lt;&lt; 8) | data[1]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            accel_temp[1] = (int16_t)(((int16_t)data[2] &lt;&lt; 8) | data[3]);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            accel_temp[2] = (int16_t)(((int16_t)data[4] &lt;&lt; 8) | data[5]);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            gyro_temp[0] = (int16_t)(((int16_t)data[6] &lt;&lt; 8) | data[7]);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            gyro_temp[1] = (int16_t)(((int16_t)data[8] &lt;&lt; 8) | data[9]);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            gyro_temp[2] = (int16_t)(((int16_t)data[10] &lt;&lt; 8) | data[11]);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment">/* Sum individual signed 16-bit biases to get accumulated signed 32-bit biases */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            accel_bias[0] += (int32_t)accel_temp[0];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            accel_bias[1] += (int32_t)accel_temp[1];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            accel_bias[2] += (int32_t)accel_temp[2];</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            gyro_bias[0] += (int32_t)gyro_temp[0];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            gyro_bias[1] += (int32_t)gyro_temp[1];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            gyro_bias[2] += (int32_t)gyro_temp[2];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">/* Normalize sums to get average count biases */</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        accel_bias[0] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        accel_bias[1] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        accel_bias[2] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        gyro_bias[0] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        gyro_bias[1] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        gyro_bias[2] /= (int32_t)packet_count;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> (accel_bias[2] &gt; 0L)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="comment">/* Remove gravity from the z-axis accelerometer bias calculation */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            accel_bias[2] -= (int32_t)accelsensitivity;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            accel_bias[2] += (int32_t)accelsensitivity;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">/* Construct the gyro biases for push to the hardware gyro bias registers, which are reset to zero upon device startup */</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">/* Divide by 4 to get 32.9 LSB per deg/s to conform to expected bias input format */</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        data[0] = (-gyro_bias[0] / 4 &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">/* Biases are additive, so change sign on calculated average gyro biases */</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        data[1] = (-gyro_bias[0] / 4) &amp; 0xFF;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        data[2] = (-gyro_bias[1] / 4 &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        data[3] = (-gyro_bias[1] / 4) &amp; 0xFF;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        data[4] = (-gyro_bias[2] / 4 &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        data[5] = (-gyro_bias[2] / 4) &amp; 0xFF;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">// Push gyro biases to hardware registers</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        writeByte(MPU6050_ADDRESS, XG_OFFS_USRH, data[0]);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        writeByte(MPU6050_ADDRESS, XG_OFFS_USRL, data[1]);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        writeByte(MPU6050_ADDRESS, YG_OFFS_USRH, data[2]);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        writeByte(MPU6050_ADDRESS, YG_OFFS_USRL, data[3]);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        writeByte(MPU6050_ADDRESS, ZG_OFFS_USRH, data[4]);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        writeByte(MPU6050_ADDRESS, ZG_OFFS_USRL, data[5]);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">/* Construct gyro bias in deg/s for later manual subtraction */</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        dest1[0] = (float)gyro_bias[0] / (<span class="keywordtype">float</span>)gyrosensitivity;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        dest1[1] = (float)gyro_bias[1] / (<span class="keywordtype">float</span>)gyrosensitivity;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        dest1[2] = (float)gyro_bias[2] / (<span class="keywordtype">float</span>)gyrosensitivity;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        int32_t accel_bias_reg[3] = {0, 0, 0};</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">/* Read factory accelerometer trim values */</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        readBytes(MPU6050_ADDRESS, XA_OFFSET_H, 2, &amp;data[0]);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        accel_bias_reg[0] = (int16_t)((int16_t)data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        readBytes(MPU6050_ADDRESS, YA_OFFSET_H, 2, &amp;data[0]);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        accel_bias_reg[1] = (int16_t)((int16_t)data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        readBytes(MPU6050_ADDRESS, ZA_OFFSET_H, 2, &amp;data[0]);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        accel_bias_reg[2] = (int16_t)((int16_t)data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">/* Define mask for temperature compensation bit 0 of lower byte of accelerometer bias registers */</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        uint32_t mask = 1uL;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="comment">/* Define array to hold mask bit for each accelerometer bias axis */</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        uint8_t mask_bit[3] = {0, 0, 0};</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">for</span> (p = 0; p &lt; 3; p++)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="comment">/* If temperature compensation bit is set, record that fact in mask_bit */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">if</span> (accel_bias_reg[p] &amp; mask)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                mask_bit[p] = 0x01;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="comment">/* Construct total accelerometer bias, including calculated average accelerometer bias from above */</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">/* Subtract calculated averaged accelerometer bias scaled to 2048 LSB/g (16 g full scale) */</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        accel_bias_reg[0] -= (accel_bias[0] / 8);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        accel_bias_reg[1] -= (accel_bias[1] / 8);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        accel_bias_reg[2] -= (accel_bias[2] / 8);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        data[0] = (accel_bias_reg[0] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        data[1] = (accel_bias_reg[0]) &amp; 0xFF;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        data[1] = data[1] | mask_bit[0];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        data[2] = (accel_bias_reg[1] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        data[3] = (accel_bias_reg[1]) &amp; 0xFF;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        data[3] = data[3] | mask_bit[1];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        data[4] = (accel_bias_reg[2] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        data[5] = (accel_bias_reg[2]) &amp; 0xFF;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        data[5] = data[5] | mask_bit[2];</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        dest2[0] = (float)accel_bias[0] / (<span class="keywordtype">float</span>)accelsensitivity;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        dest2[1] = (float)accel_bias[1] / (<span class="keywordtype">float</span>)accelsensitivity;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        dest2[2] = (float)accel_bias[2] / (<span class="keywordtype">float</span>)accelsensitivity;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;};</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassMPU6050_html"><div class="ttname"><a href="classMPU6050.html">MPU6050</a></div><div class="ttdef"><b>Definition:</b> mpu6050.h:221</div></div>
<div class="ttc" id="aclassMPU6050_html_a0f2fa52481baa9149ae3de0f4f1ccd55"><div class="ttname"><a href="classMPU6050.html#a0f2fa52481baa9149ae3de0f4f1ccd55">MPU6050::getTinyGyroY</a></div><div class="ttdeci">uint8_t getTinyGyroY(void)</div><div class="ttdoc">Gettin gyro-Y value.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:360</div></div>
<div class="ttc" id="aclassMPU6050_html_a144c5eeb14c620d9df9bb601dabcdfe4"><div class="ttname"><a href="classMPU6050.html#a144c5eeb14c620d9df9bb601dabcdfe4">MPU6050::lowPowerAccelOnly</a></div><div class="ttdeci">void lowPowerAccelOnly()</div><div class="ttdoc">Configure the motion detection control for low power accelerometer mode.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:388</div></div>
<div class="ttc" id="aclassMPU6050_html_a25e6783c8ced9bddbf7a76ad6c0d862b"><div class="ttname"><a href="classMPU6050.html#a25e6783c8ced9bddbf7a76ad6c0d862b">MPU6050::getTinyGyroX</a></div><div class="ttdeci">uint8_t getTinyGyroX(void)</div><div class="ttdoc">Gettin gyro-X value.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:348</div></div>
<div class="ttc" id="aclassMPU6050_html_a6c1feece6ebce637f1dfc62b4e51b505"><div class="ttname"><a href="classMPU6050.html#a6c1feece6ebce637f1dfc62b4e51b505">MPU6050::getGres</a></div><div class="ttdeci">void getGres()</div><div class="ttdoc">Possible gyro scales.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:262</div></div>
<div class="ttc" id="aclassMPU6050_html_a7100b6d276c3c8664cf00d768b7b0dee"><div class="ttname"><a href="classMPU6050.html#a7100b6d276c3c8664cf00d768b7b0dee">MPU6050::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Reset MPU device.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:454</div></div>
<div class="ttc" id="aclassMPU6050_html_a85697978821b9750a663ad0da2665149"><div class="ttname"><a href="classMPU6050.html#a85697978821b9750a663ad0da2665149">MPU6050::readGyroData</a></div><div class="ttdeci">void readGyroData(int16_t *destination)</div><div class="ttdoc">Read x/y/z gyro data.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:332</div></div>
<div class="ttc" id="aclassMPU6050_html_a9e714480274e46034d7178f31401095e"><div class="ttname"><a href="classMPU6050.html#a9e714480274e46034d7178f31401095e">MPU6050::calibrate</a></div><div class="ttdeci">void calibrate(float *dest1, float *dest2)</div><div class="ttdoc">Calibrate device before adress advertising.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:517</div></div>
<div class="ttc" id="aclassMPU6050_html_ac13cbf2fc086558a1aaab5ad0ac350e5"><div class="ttname"><a href="classMPU6050.html#ac13cbf2fc086558a1aaab5ad0ac350e5">MPU6050::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Initialize MPU device.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:469</div></div>
<div class="ttc" id="aclassMPU6050_html_ad4c9e5da02513d6da3226e61717f45d8"><div class="ttname"><a href="classMPU6050.html#ad4c9e5da02513d6da3226e61717f45d8">MPU6050::getAres</a></div><div class="ttdeci">void getAres()</div><div class="ttdoc">Possible accelerometer scales.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:288</div></div>
<div class="ttc" id="aclassMPU6050_html_aeba6e510256e9ce45d60ad5f2e9730ea"><div class="ttname"><a href="classMPU6050.html#aeba6e510256e9ce45d60ad5f2e9730ea">MPU6050::readAccelData</a></div><div class="ttdeci">void readAccelData(int16_t *destination)</div><div class="ttdoc">Read x/y/z accel data.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:315</div></div>
<div class="ttc" id="aclassMPU6050_html_af9abab30196b2e4aa39aaa19d361cef4"><div class="ttname"><a href="classMPU6050.html#af9abab30196b2e4aa39aaa19d361cef4">MPU6050::getTinyGyroZ</a></div><div class="ttdeci">uint8_t getTinyGyroZ(void)</div><div class="ttdoc">Gettin gyro-Z value.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:372</div></div>
<div class="ttc" id="ampu6050_8h_html_a37998c0193af36b17d82e8811c3a8c21"><div class="ttname"><a href="mpu6050_8h.html#a37998c0193af36b17d82e8811c3a8c21">fromADCtoInt</a></div><div class="ttdeci">long fromADCtoInt(long value, long from_min, long from_max, long to_min, long to_max)</div><div class="ttdoc">Mapping two values, based on ranges.</div><div class="ttdef"><b>Definition:</b> mpu6050.h:215</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
